<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome to Saekim</title>
    <link rel="stylesheet" href="css/welcome.css">
    <script src="qrc:///qtwebchannel/qwebchannel.js"></script>
</head>

<body>
    <div class="welcome-screen">
        <div class="welcome-card" id="welcome-card">
            <div class="button-container">
                <button id="btn-open-folder" class="btn btn-primary">
                    <span class="icon" id="icon-open-folder"></span> 폴더 열기
                </button>
                <button id="btn-open-file" class="btn btn-secondary">
                    <span class="icon" id="icon-open-file"></span> 파일 열기
                </button>
                <button id="btn-new-file" class="btn btn-secondary">
                    <span class="icon" id="icon-new-file"></span> 새 파일
                </button>
            </div>
        </div>
    </div>

    <script>
        let backend = null;

        // Initialize QWebChannel
        new QWebChannel(qt.webChannelTransport, function (channel) {
            backend = channel.objects.backend;
        });

        // Button Event Listeners
        document.getElementById('btn-open-folder').addEventListener('click', () => {
            if (backend) backend.open_folder_dialog();
        });

        document.getElementById('btn-open-file').addEventListener('click', () => {
            if (backend) backend.open_file_dialog();
        });

        document.getElementById('btn-new-file').addEventListener('click', () => {
            if (backend) backend.new_file();
        });

        // Icon Update Function
        function updateIcons(icons) {
            if (icons.open_folder) document.getElementById('icon-open-folder').innerHTML = icons.open_folder;
            if (icons.open_file) document.getElementById('icon-open-file').innerHTML = icons.open_file;
            if (icons.new_file) document.getElementById('icon-new-file').innerHTML = icons.new_file;
        }

        // Theme Update Function (called from Python)
        function updateTheme(themeData) {
            const root = document.documentElement;

            // Set colors based on theme data
            if (themeData.is_dark) {
                root.style.setProperty('--bg-color', '#2E3440');
                root.style.setProperty('--card-bg', 'transparent'); // Transparent as requested
                root.style.setProperty('--text-color', '#ECEFF4');
                root.style.setProperty('--btn-primary-bg', '#88C0D0');
                root.style.setProperty('--btn-primary-text', '#2E3440');
                root.style.setProperty('--btn-secondary-bg', '#434C5E');
                root.style.setProperty('--btn-secondary-text', '#ECEFF4');
            } else {
                root.style.setProperty('--bg-color', '#FFFFFF');
                root.style.setProperty('--card-bg', 'transparent');
                root.style.setProperty('--text-color', '#24292F');
                root.style.setProperty('--btn-primary-bg', '#0969DA');
                root.style.setProperty('--btn-primary-text', '#FFFFFF');
                root.style.setProperty('--btn-secondary-bg', '#F6F8FA');
                root.style.setProperty('--btn-secondary-text', '#24292F');
            }

            // Override with specific theme colors if needed
            if (themeData.name === 'Nord') {
                root.style.setProperty('--bg-color', '#2E3440');
                root.style.setProperty('--btn-primary-bg', '#88C0D0');
                root.style.setProperty('--btn-primary-text', '#2E3440');
            } else if (themeData.name === 'GitHub Primer') { // Black
                root.style.setProperty('--bg-color', '#0D1117');
                root.style.setProperty('--btn-primary-bg', '#238636');
                root.style.setProperty('--btn-primary-text', '#FFFFFF');
            } else if (themeData.name === 'White') { // Paper
                root.style.setProperty('--bg-color', '#FFFFFF');
                root.style.setProperty('--btn-primary-bg', '#2196F3');
                root.style.setProperty('--btn-primary-text', '#FFFFFF');
            } else if (themeData.name === 'Catppuccin Mocha') {
                root.style.setProperty('--bg-color', '#1E1E2E');
                root.style.setProperty('--btn-primary-bg', '#89B4FA');
                root.style.setProperty('--btn-primary-text', '#1E1E2E');
            }
        }
    </script>
</body>

</html>